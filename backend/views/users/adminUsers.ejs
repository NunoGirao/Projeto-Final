<!DOCTYPE html>
<html>
<head>
  <title>Admin Users</title>
</head>
<style>
  body {
    font-family: Arial, sans-serif;
    margin: 0;
    padding: 20px;
    background-color: #f4f4f4;
  }

  h1 {
    color: #333;
    margin-bottom: 20px;
    text-align: center;
  }

  h2 {
    color: #555;
    margin-bottom: 10px;
  }

  button {
    background-color: #007bff;
    color: white;
    padding: 10px 20px;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    margin-bottom: 10px;
    transition: background-color 0.3s ease;
  }

  button:hover {
    background-color: #0056b3;
  }

  ul {
    list-style-type: none;
    padding: 0;
    margin: 0;
  }

  li {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 10px;
    background-color: white;
    padding: 10px;
    border-radius: 4px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  }

  a {
    text-decoration: none;
    color: #333;
  }

  a:hover {
    text-decoration: underline;
  }

  #goToDashboard {
    margin-top: 20px;
    align-self: flex-start;
  }
</style>
<body>
  <h1>Utilizadores Administrativos</h1>

  <h2>Todos os Utilizadores</h2>
  <button id="fetchUsers">Procurar Utilizadores</button>
  <ul id="usersList"></ul>

  <button id="goToDashboard">Voltar ao Painel</button>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const token = localStorage.getItem('adminToken');
      if (!token) {
        window.location.href = '/admin';
        return;
      }

      document.getElementById('fetchUsers').addEventListener('click', fetchUsers);
      document.getElementById('goToDashboard').addEventListener('click', function() {
        window.location.href = '/admin/dashboard';
      });

      async function fetchUsers() {
        const response = await fetch('/api/admin/users', {
          method: 'GET',
          headers: {
            'x-access-token': token
          }
        });

        const users = await response.json();
        const usersList = document.getElementById('usersList');
        usersList.innerHTML = '';
        users.forEach(user => {
          const li = document.createElement('li');
          const link = document.createElement('a');
          link.href = `/admin/users/view/${user._id}`;
          link.textContent = `${user.name} (${user.email})`;
          li.appendChild(link);
          const button = document.createElement('button');
          button.textContent = 'Edit';
          button.onclick = function() { editUser(user._id); };
          li.appendChild(button);
          usersList.appendChild(li);
        });
      }

      window.editUser = function(id) {
        window.location.href = `/admin/users/edit/${id}`;
      };

      fetchUsers();
    });
  </script>
</body>
</html>
